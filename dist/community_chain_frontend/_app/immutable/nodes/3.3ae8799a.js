import{s as Ge,c as ke,o as Ke,n as Be,d as Z}from"../chunks/scheduler.dd7510fc.js";import{S as Qe,i as Re,s as C,g as v,A as We,f as u,c as E,h as d,j as b,k as p,a as T,t as De,b as Xe,d as Se,p as Ye,m as w,n as P,x as O,y as r,o as N,r as Ze,u as xe,v as $e,w as et,z as Je}from"../chunks/index.0a6f24ed.js";import{p as tt}from"../chunks/stores.aad8a317.js";import{a as Ae,b as st,c as lt}from"../chunks/activities.eaf521bd.js";import{a as at,d as rt}from"../chunks/auth.cb16a316.js";import{L as nt}from"../chunks/LoadingSpinner.93b7a589.js";function ot(i){let e,t,n,s,l,o=(i[0].title||"無題の活動")+"",a,c,g,f=i[9](i[0].status)+"",m,S,V,j,I,H,L,le="場所:",x,_,q=(i[0].location||"未設定")+"",ae,_e,z,J,Ie="報酬:",he,G,$=(i[0].reward||0)+"",re,me,be,B,K,we="作成日:",ge,R,ee=i[8](i[0].created_at)+"",ne,ye,U,Q,Pe="活動内容",je,te,se=(i[0].description||"説明はありません")+"",oe,Ce,Ee,M,ie,F,Ve="一覧に戻る",k=i[5]&&Ue(i),A=i[0].assignee&&Fe(i);function Ne(h,y){if(h[7])return vt;if(h[6])return ft;if(h[1])return ut}let W=Ne(i),D=W&&W(i);return{c(){k&&k.c(),e=C(),t=v("div"),n=v("div"),s=v("div"),l=v("h1"),a=w(o),c=C(),g=v("span"),m=w(f),V=C(),j=v("div"),I=v("div"),H=v("div"),L=v("span"),L.textContent=le,x=C(),_=v("span"),ae=w(q),_e=C(),z=v("div"),J=v("span"),J.textContent=Ie,he=C(),G=v("span"),re=w($),me=w(" ポイント"),be=C(),B=v("div"),K=v("span"),K.textContent=we,ge=C(),R=v("span"),ne=w(ee),ye=C(),U=v("div"),Q=v("h3"),Q.textContent=Pe,je=C(),te=v("p"),oe=w(se),Ce=C(),A&&A.c(),Ee=C(),M=v("div"),D&&D.c(),ie=C(),F=v("a"),F.textContent=Ve,this.h()},l(h){k&&k.l(h),e=E(h),t=d(h,"DIV",{class:!0});var y=b(t);n=d(y,"DIV",{class:!0});var Te=b(n);s=d(Te,"DIV",{class:!0});var ce=b(s);l=d(ce,"H1",{class:!0});var He=b(l);a=P(He,o),He.forEach(u),c=E(ce),g=d(ce,"SPAN",{class:!0});var Le=b(g);m=P(Le,f),Le.forEach(u),ce.forEach(u),Te.forEach(u),V=E(y),j=d(y,"DIV",{class:!0});var X=b(j);I=d(X,"DIV",{class:!0});var Y=b(I);H=d(Y,"DIV",{class:!0});var ue=b(H);L=d(ue,"SPAN",{class:!0,"data-svelte-h":!0}),O(L)!=="svelte-wnzubp"&&(L.textContent=le),x=E(ue),_=d(ue,"SPAN",{class:!0});var Me=b(_);ae=P(Me,q),Me.forEach(u),ue.forEach(u),_e=E(Y),z=d(Y,"DIV",{class:!0});var fe=b(z);J=d(fe,"SPAN",{class:!0,"data-svelte-h":!0}),O(J)!=="svelte-i7n1r6"&&(J.textContent=Ie),he=E(fe),G=d(fe,"SPAN",{class:!0});var qe=b(G);re=P(qe,$),me=P(qe," ポイント"),qe.forEach(u),fe.forEach(u),be=E(Y),B=d(Y,"DIV",{class:!0});var ve=b(B);K=d(ve,"SPAN",{class:!0,"data-svelte-h":!0}),O(K)!=="svelte-1mqaybe"&&(K.textContent=we),ge=E(ve),R=d(ve,"SPAN",{class:!0});var Oe=b(R);ne=P(Oe,ee),Oe.forEach(u),ve.forEach(u),Y.forEach(u),ye=E(X),U=d(X,"DIV",{class:!0});var de=b(U);Q=d(de,"H3",{class:!0,"data-svelte-h":!0}),O(Q)!=="svelte-1jbv9dm"&&(Q.textContent=Pe),je=E(de),te=d(de,"P",{});var ze=b(te);oe=P(ze,se),ze.forEach(u),de.forEach(u),Ce=E(X),A&&A.l(X),X.forEach(u),Ee=E(y),M=d(y,"DIV",{class:!0});var pe=b(M);D&&D.l(pe),ie=E(pe),F=d(pe,"A",{href:!0,class:!0,"data-svelte-h":!0}),O(F)!=="svelte-1xjjkt9"&&(F.textContent=Ve),pe.forEach(u),y.forEach(u),this.h()},h(){p(l,"class","activity-title svelte-jv6qo4"),p(g,"class",S=Be(`status status-${i[0].status||"unknown"}`)+" svelte-jv6qo4"),p(s,"class","flex-between svelte-jv6qo4"),p(n,"class","card-header"),p(L,"class","meta-label svelte-jv6qo4"),p(_,"class","meta-value svelte-jv6qo4"),p(H,"class","meta-item svelte-jv6qo4"),p(J,"class","meta-label svelte-jv6qo4"),p(G,"class","meta-value svelte-jv6qo4"),p(z,"class","meta-item svelte-jv6qo4"),p(K,"class","meta-label svelte-jv6qo4"),p(R,"class","meta-value svelte-jv6qo4"),p(B,"class","meta-item svelte-jv6qo4"),p(I,"class","meta-info svelte-jv6qo4"),p(Q,"class","svelte-jv6qo4"),p(U,"class","description svelte-jv6qo4"),p(j,"class","card-body"),p(F,"href","/"),p(F,"class","btn btn-outline"),p(M,"class","card-footer svelte-jv6qo4"),p(t,"class","card")},m(h,y){k&&k.m(h,y),T(h,e,y),T(h,t,y),r(t,n),r(n,s),r(s,l),r(l,a),r(s,c),r(s,g),r(g,m),r(t,V),r(t,j),r(j,I),r(I,H),r(H,L),r(H,x),r(H,_),r(_,ae),r(I,_e),r(I,z),r(z,J),r(z,he),r(z,G),r(G,re),r(G,me),r(I,be),r(I,B),r(B,K),r(B,ge),r(B,R),r(R,ne),r(j,ye),r(j,U),r(U,Q),r(U,je),r(U,te),r(te,oe),r(j,Ce),A&&A.m(j,null),r(t,Ee),r(t,M),D&&D.m(M,null),r(M,ie),r(M,F)},p(h,y){h[5]?k?k.p(h,y):(k=Ue(h),k.c(),k.m(e.parentNode,e)):k&&(k.d(1),k=null),y&1&&o!==(o=(h[0].title||"無題の活動")+"")&&N(a,o),y&1&&f!==(f=h[9](h[0].status)+"")&&N(m,f),y&1&&S!==(S=Be(`status status-${h[0].status||"unknown"}`)+" svelte-jv6qo4")&&p(g,"class",S),y&1&&q!==(q=(h[0].location||"未設定")+"")&&N(ae,q),y&1&&$!==($=(h[0].reward||0)+"")&&N(re,$),y&1&&ee!==(ee=h[8](h[0].created_at)+"")&&N(ne,ee),y&1&&se!==(se=(h[0].description||"説明はありません")+"")&&N(oe,se),h[0].assignee?A?A.p(h,y):(A=Fe(h),A.c(),A.m(j,null)):A&&(A.d(1),A=null),W===(W=Ne(h))&&D?D.p(h,y):(D&&D.d(1),D=W&&W(h),D&&(D.c(),D.m(M,ie)))},i:Z,o:Z,d(h){h&&(u(e),u(t)),k&&k.d(h),A&&A.d(),D&&D.d()}}}function it(i){let e,t,n,s,l,o="一覧に戻る";return{c(){e=v("div"),t=v("p"),n=w(i[3]),s=C(),l=v("a"),l.textContent=o,this.h()},l(a){e=d(a,"DIV",{class:!0});var c=b(e);t=d(c,"P",{});var g=b(t);n=P(g,i[3]),g.forEach(u),s=E(c),l=d(c,"A",{href:!0,class:!0,"data-svelte-h":!0}),O(l)!=="svelte-111jbnl"&&(l.textContent=o),c.forEach(u),this.h()},h(){p(l,"href","/"),p(l,"class","btn btn-primary"),p(e,"class","alert alert-danger svelte-jv6qo4")},m(a,c){T(a,e,c),r(e,t),r(t,n),r(e,s),r(e,l)},p(a,c){c&8&&N(n,a[3])},i:Z,o:Z,d(a){a&&u(e)}}}function ct(i){let e,t,n,s,l="活動データを読み込み中...",o;return t=new nt({}),{c(){e=v("div"),Ze(t.$$.fragment),n=C(),s=v("p"),s.textContent=l,this.h()},l(a){e=d(a,"DIV",{class:!0});var c=b(e);xe(t.$$.fragment,c),n=E(c),s=d(c,"P",{"data-svelte-h":!0}),O(s)!=="svelte-1cqsa8w"&&(s.textContent=l),c.forEach(u),this.h()},h(){p(e,"class","loading svelte-jv6qo4")},m(a,c){T(a,e,c),$e(t,e,null),r(e,n),r(e,s),o=!0},p:Z,i(a){o||(Se(t.$$.fragment,a),o=!0)},o(a){De(t.$$.fragment,a),o=!1},d(a){a&&u(e),et(t)}}}function Ue(i){let e,t,n;return{c(){e=v("div"),t=v("p"),n=w(i[5]),this.h()},l(s){e=d(s,"DIV",{class:!0});var l=b(e);t=d(l,"P",{});var o=b(t);n=P(o,i[5]),o.forEach(u),l.forEach(u),this.h()},h(){p(e,"class","alert alert-success svelte-jv6qo4")},m(s,l){T(s,e,l),r(e,t),r(t,n)},p(s,l){l&32&&N(n,s[5])},d(s){s&&u(e)}}}function Fe(i){let e,t,n="参加者",s,l,o=String(i[0].assignee)+"",a;return{c(){e=v("div"),t=v("h3"),t.textContent=n,s=C(),l=v("p"),a=w(o),this.h()},l(c){e=d(c,"DIV",{class:!0});var g=b(e);t=d(g,"H3",{class:!0,"data-svelte-h":!0}),O(t)!=="svelte-1l067dl"&&(t.textContent=n),s=E(g),l=d(g,"P",{class:!0});var f=b(l);a=P(f,o),f.forEach(u),g.forEach(u),this.h()},h(){p(t,"class","svelte-jv6qo4"),p(l,"class","principal-id svelte-jv6qo4"),p(e,"class","assignee svelte-jv6qo4")},m(c,g){T(c,e,g),r(e,t),r(e,s),r(e,l),r(l,a)},p(c,g){g&1&&o!==(o=String(c[0].assignee)+"")&&N(a,o)},d(c){c&&u(e)}}}function ut(i){let e,t="<span>あなたが作成した活動です</span>";return{c(){e=v("div"),e.innerHTML=t,this.h()},l(n){e=d(n,"DIV",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-124bw4l"&&(e.innerHTML=t),this.h()},h(){p(e,"class","creator-badge svelte-jv6qo4")},m(n,s){T(n,e,s)},p:Z,d(n){n&&u(e)}}}function ft(i){let e,t=i[4]?"処理中...":"活動完了を報告する",n,s,l;return{c(){e=v("button"),n=w(t),this.h()},l(o){e=d(o,"BUTTON",{class:!0});var a=b(e);n=P(a,t),a.forEach(u),this.h()},h(){p(e,"class","btn btn-success"),e.disabled=i[4]},m(o,a){T(o,e,a),r(e,n),s||(l=Je(e,"click",i[11]),s=!0)},p(o,a){a&16&&t!==(t=o[4]?"処理中...":"活動完了を報告する")&&N(n,t),a&16&&(e.disabled=o[4])},d(o){o&&u(e),s=!1,l()}}}function vt(i){let e,t=i[4]?"処理中...":"この活動に参加する",n,s,l;return{c(){e=v("button"),n=w(t),this.h()},l(o){e=d(o,"BUTTON",{class:!0});var a=b(e);n=P(a,t),a.forEach(u),this.h()},h(){p(e,"class","btn btn-primary"),e.disabled=i[4]},m(o,a){T(o,e,a),r(e,n),s||(l=Je(e,"click",i[10]),s=!0)},p(o,a){a&16&&t!==(t=o[4]?"処理中...":"この活動に参加する")&&N(n,t),a&16&&(e.disabled=o[4])},d(o){o&&u(e),s=!1,l()}}}function dt(i){let e,t,n,s,l,o;document.title=e=i[0]?`${i[0].title||"無題の活動"} - コミュニティチェーン`:"コミュニティチェーン";const a=[ct,it,ot],c=[];function g(f,m){return f[2]?0:f[3]?1:f[0]?2:-1}return~(s=g(i))&&(l=c[s]=a[s](i)),{c(){t=C(),n=v("section"),l&&l.c(),this.h()},l(f){We("svelte-m4dlte",document.head).forEach(u),t=E(f),n=d(f,"SECTION",{class:!0});var S=b(n);l&&l.l(S),S.forEach(u),this.h()},h(){p(n,"class","container")},m(f,m){T(f,t,m),T(f,n,m),~s&&c[s].m(n,null),o=!0},p(f,[m]){(!o||m&1)&&e!==(e=f[0]?`${f[0].title||"無題の活動"} - コミュニティチェーン`:"コミュニティチェーン")&&(document.title=e);let S=s;s=g(f),s===S?~s&&c[s].p(f,m):(l&&(Ye(),De(c[S],1,1,()=>{c[S]=null}),Xe()),~s?(l=c[s],l?l.p(f,m):(l=c[s]=a[s](f),l.c()),Se(l,1),l.m(n,null)):l=null)},i(f){o||(Se(l),o=!0)},o(f){De(l),o=!1},d(f){f&&(u(t),u(n)),~s&&c[s].d()}}}function pt(i,e,t){let n,s,l,o,a,c,g;ke(i,at,_=>t(13,a=_)),ke(i,rt,_=>t(14,c=_)),ke(i,tt,_=>t(15,g=_));const f=g.params.id;let m=null,S=!0,V=null,j=!1,I=null;const H=_=>{try{return _?new Date(Number(_)/1e6).toLocaleString("ja-JP"):"日付情報なし"}catch(q){return console.error("日付変換エラー:",q),"日付変換エラー"}},L=_=>{if(!_)return"不明";switch(_){case"open":return"募集中";case"assigned":return"進行中";case"completed":return"完了";default:return _}};Ke(async()=>{try{console.log(`活動詳細を取得中: ID=${f}`);const _=await Ae(f);console.log("活動データ取得結果:",_),_?(t(0,m=Array.isArray(_)?_[0]:_),console.log("活動データをセット:",m)):t(3,V="指定された活動が見つかりません。")}catch(_){t(3,V="活動データの読み込みに失敗しました。"),console.error("活動データ取得エラー:",_)}finally{t(2,S=!1)}});async function le(){if(!a){alert("参加するにはログインが必要です。");return}t(4,j=!0);try{if(await st(f)){t(5,I="参加申請が受理されました！");const q=await Ae(f);t(0,m=Array.isArray(q)?q[0]:q)}else t(3,V="参加申請に失敗しました。")}catch(_){t(3,V="参加申請処理中にエラーが発生しました。"),console.error("参加申請エラー:",_)}finally{t(4,j=!1)}}async function x(){if(!a){alert("活動を完了するにはログインが必要です。");return}t(4,j=!0);try{if(await lt(f)){t(5,I="活動完了の報告が受理されました！");const q=await Ae(f);t(0,m=Array.isArray(q)?q[0]:q)}else t(3,V="活動完了の報告に失敗しました。")}catch(_){t(3,V="活動完了処理中にエラーが発生しました。"),console.error("活動完了エラー:",_)}finally{t(4,j=!1)}}return i.$$.update=()=>{i.$$.dirty&16385&&t(1,n=m&&c.principal&&m.creator&&m.creator.toString()===c.principal),i.$$.dirty&16385&&t(12,s=m&&m.assignee&&c.principal&&m.assignee.toString()===c.principal),i.$$.dirty&8195&&t(7,l=a&&m&&m.status==="open"&&!n),i.$$.dirty&12289&&t(6,o=a&&m&&m.status==="assigned"&&s)},[m,n,S,V,j,I,o,l,H,L,le,x,s,a,c]}class jt extends Qe{constructor(e){super(),Re(this,e,pt,dt,Ge,{})}}export{jt as component};
